---
sidebar_label: Fichier CSV
sidebar_position: 2
---

# Fichiers CSV

## Introduction aux fichiers CSV

Le format CSV (Comma Separated Values) est tr√®s utilis√© pour repr√©senter des
donn√©es sous forme de tableau. Chaque ligne correspond √† une entr√©e et chaque
colonne est s√©par√©e par un d√©limiteur, g√©n√©ralement une virgule ou un
point-virgule. Ce format est couramment utilis√© pour exporter ou importer des
donn√©es vers des applications telles que Excel ou pour transmettre des donn√©es
structur√©es entre diff√©rentes plateformes.

## Lire un fichier CSV

Python fournit le module int√©gr√© `csv` pour simplifier la lecture et l'√©criture
de fichiers CSV. Voici comment l'utiliser efficacement.

### Exemple de lecture simple

La m√©thode la plus simple pour lire un fichier CSV est d'utiliser `csv.reader`,
qui lit chaque ligne comme une *liste* de valeurs. Voici un exemple concret :

```python
import csv

with open('donnees.csv', 'r', newline='', encoding='utf-8') as fichier:
    lecteur = csv.reader(fichier, delimiter=',')
    for ligne in lecteur:
        print(ligne)
```

Dans cet exemple, chaque ligne du fichier est affich√©e comme une liste Python.

### Lecture avec `DictReader`

Le `DictReader` est particuli√®rement utile car il permet d'acc√©der aux donn√©es
via les noms des colonnes sp√©cifi√©es dans la premi√®re ligne du fichier CSV.
C'est id√©al pour rendre le code plus lisible et intuitif :

```python
import csv

with open('donnees.csv', 'r', newline='', encoding='utf-8') as fichier:
    lecteur = csv.DictReader(fichier)
    for ligne in lecteur:
        print(f"Nom: {ligne['Nom']}, √Çge: {ligne['√Çge']}")
```

Ici, l'acc√®s aux donn√©es par le nom des colonnes am√©liore nettement la
lisibilit√© et la compr√©hension du code.

---

## √âcrire dans un fichier CSV

L'√©criture dans un fichier CSV est aussi simplifi√©e gr√¢ce au module `csv`. Nous
avons plusieurs fa√ßons d'√©crire des donn√©es, chacune adapt√©e √† diff√©rents
contextes.

### √âcriture simple avec `writer`

Pour √©crire rapidement des donn√©es dans un fichier CSV, vous pouvez utiliser
`csv.writer`. Voici comment √©crire une liste de listes dans un fichier :

```python
import csv

donnees = [
    ['Nom', '√Çge', 'Ville'],
    ['Alice', 30, 'Paris'],
    ['Bob', 25, 'Lyon'],
    ['Charlie', 35, 'Marseille']
]

with open('sortie.csv', 'w', newline='', encoding='utf-8') as fichier:
    ecrivain = csv.writer(fichier)
    ecrivain.writerows(donnees)
```

Cet exemple cr√©e un fichier CSV complet avec des ent√™tes et plusieurs lignes de
donn√©es.

### √âcriture avec `DictWriter`

Si vous travaillez avec des donn√©es sous forme de dictionnaires, le
`csv.DictWriter` est particuli√®rement adapt√©. Il permet d'associer clairement
chaque valeur √† une colonne sp√©cifique du fichier CSV :

```python
import csv

champs = ['Nom', '√Çge', 'Ville']
donnees = [
    {'Nom': 'Alice', '√Çge': 30, 'Ville': 'Paris'},
    {'Nom': 'Bob', '√Çge': 25, 'Ville': 'Lyon'},
    {'Nom': 'Charlie', '√Çge': 35, 'Ville': 'Marseille'}
]

with open('sortie.csv', 'w', newline='', encoding='utf-8') as fichier:
    ecrivain = csv.DictWriter(fichier, fieldnames=champs)
    ecrivain.writeheader()
    ecrivain.writerows(donnees)
```

## Traitement des donn√©es CSV : exemple pratique

Voici un exemple pratique o√π nous traitons un fichier CSV pour extraire et
sauvegarder seulement les personnes √¢g√©es de 30 ans ou plus. Cet exemple
illustre la puissance de combinaison de lecture et d'√©criture avec `DictReader`
et `DictWriter` :

```python
import csv

resultats = []
with open('personnes.csv', 'r', newline='', encoding='utf-8') as entree:
    lecteur = csv.DictReader(entree)
    for ligne in lecteur:
        if int(ligne['√Çge']) >= 30:
            resultats.append(ligne)

with open('personnes_filtrees.csv', 'w', newline='', encoding='utf-8') as sortie:
    champs = ['Nom', '√Çge', 'Ville']
    ecrivain = csv.DictWriter(sortie, fieldnames=champs)
    ecrivain.writeheader()
    ecrivain.writerows(resultats)
```

## Bonnes pratiques pour les fichiers CSV

Il est important de respecter certaines bonnes pratiques lors de la
manipulation des fichiers CSV :

- Toujours pr√©ciser `newline=''` lors de l'ouverture des fichiers CSV pour
  √©viter les probl√®mes de sauts de ligne inattendus. `newline=''` indique √† la fonction
  `open` de ne pas modifier les sauts de ligne, car c'est le module `csv` qui
  va les g√©rer.
- Utiliser syst√©matiquement l'encodage `encoding='utf-8'` pour g√©rer
  correctement les caract√®res sp√©ciaux.
- Pr√©f√©rer l'utilisation de `DictReader` et `DictWriter` pour simplifier
  l'acc√®s et la gestion des donn√©es en fonction des noms de colonnes.


## Testez votre compr√©hension

<details>
<summary>ü§î Testez votre compr√©hension - Indexation</summary>

<MultipleChoiceTabs>

<MultipleChoice>
Quel module standard est utilis√© pour lire un fichier CSV en Python ?
<MultipleChoiceOption isCorrect>
csv
</MultipleChoiceOption>
<MultipleChoiceOption>
json
</MultipleChoiceOption>
<MultipleChoiceOption>
pandas
</MultipleChoiceOption>
</MultipleChoice>

<MultipleChoice>
Quel est l'effet de l'instruction `with open("data.csv") as f:` ?
<MultipleChoiceOption isCorrect>
Elle ouvre le fichier et le referme automatiquement √† la fin du bloc.
</MultipleChoiceOption>
<MultipleChoiceOption>
Elle lit tout le fichier ligne par ligne dans une liste.
</MultipleChoiceOption>
<MultipleChoiceOption>
Elle supprime le fichier apr√®s lecture.
</MultipleChoiceOption>
</MultipleChoice>

<MultipleChoice>
Que retourne `csv.reader(f)` ?
<MultipleChoiceOption>
Un dictionnaire avec les noms de colonnes.
</MultipleChoiceOption>
<MultipleChoiceOption isCorrect>
Un it√©rateur o√π chaque ligne est une liste de cha√Ænes de caract√®res.
</MultipleChoiceOption>
<MultipleChoiceOption>
Une seule liste contenant tout le contenu du fichier.
</MultipleChoiceOption>
</MultipleChoice>

<MultipleChoice>
Quel est l‚Äôint√©r√™t de `csv.DictReader(f)` ?
<MultipleChoiceOption isCorrect>
Il lit chaque ligne comme un dictionnaire avec les noms de colonnes comme cl√©s.
</MultipleChoiceOption>
<MultipleChoiceOption>
Il retourne le fichier entier comme une seule cha√Æne de caract√®res.
</MultipleChoiceOption>
<MultipleChoiceOption>
Il ignore la premi√®re ligne du fichier.
</MultipleChoiceOption>
</MultipleChoice>

<MultipleChoice>
Que faut-il ajouter √† `open()` pour bien lire les accents dans un fichier CSV ?
<MultipleChoiceOption isCorrect>
`encoding="utf-8"`
</MultipleChoiceOption>
<MultipleChoiceOption>
`delimiter=";"`
</MultipleChoiceOption>
<MultipleChoiceOption>
`mode="binary"`
</MultipleChoiceOption>
</MultipleChoice>

<MultipleChoice>
Quel est le s√©parateur par d√©faut utilis√© par `csv.reader()` ?
<MultipleChoiceOption isCorrect>
La virgule (`,`)
</MultipleChoiceOption>
<MultipleChoiceOption>
Le point-virgule (`;`)
</MultipleChoiceOption>
<MultipleChoiceOption>
Le tabulateur (`\t`)
</MultipleChoiceOption>
</MultipleChoice>

<MultipleChoice>
Quelle m√©thode permet de transformer un objet `csv.reader` en liste ?
<MultipleChoiceOption isCorrect>
`list(reader)`
</MultipleChoiceOption>
<MultipleChoiceOption>
`reader.to_list()`
</MultipleChoiceOption>
<MultipleChoiceOption isCorrect>
Une boucle for ou un appel √† `list()`
</MultipleChoiceOption>
</MultipleChoice>

<MultipleChoice>
Comment acc√©der √† la valeur d‚Äôune colonne nomm√©e `"nom"` avec `csv.DictReader` ?
<MultipleChoiceOption isCorrect>
`ligne["nom"]`
</MultipleChoiceOption>
<MultipleChoiceOption>
`ligne.nom`
</MultipleChoiceOption>

</MultipleChoice>

<MultipleChoice>
Pourquoi utilise-t-on `newline=""` dans `open("fichier.csv", newline="")` ?
<MultipleChoiceOption isCorrect>
Pour √©viter des lignes vides entre les lignes lues sous Windows.
</MultipleChoiceOption>
<MultipleChoiceOption isCorrect>
Pour que `csv.reader` g√®re correctement les retours √† la ligne.
</MultipleChoiceOption>
<MultipleChoiceOption>
Pour supprimer tous les caract√®res `\n` du fichier.
</MultipleChoiceOption>
</MultipleChoice>

<MultipleChoice>
Que fait cette s√©quence ?
```python
import csv
with open("f.csv", encoding="utf-8") as f:
    for ligne in csv.reader(f):
        print(ligne)
```

<MultipleChoiceOption isCorrect>
Elle lit chaque ligne du fichier CSV et l'affiche comme une liste de cha√Ænes.
</MultipleChoiceOption>
<MultipleChoiceOption>
Elle lit tout le fichier et retourne un dictionnaire par ligne.
</MultipleChoiceOption>
<MultipleChoiceOption>
Elle enregistre chaque ligne dans un fichier diff√©rent.
</MultipleChoiceOption>
</MultipleChoice>

</MultipleChoiceTabs>
</details>